<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <title>AnoDDPM</title>

    <!-- Favicons -->
    <link href="https://img.icons8.com/nolan/64/code-fork.png" rel="icon">
    <link href="https://img.icons8.com/nolan/64/code-fork.png" rel="apple-touch-icon">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Satisfy" rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/vendor/icofont/icofont.min.css" rel="stylesheet">
    <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
    <link href="assets/vendor/owl.carousel/assets/owl.carousel.min.css" rel="stylesheet">
    <!-- <link href="assets/vendor/venobox/venobox.css" rel="stylesheet"> -->

    <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>

    <!-- Template Main CSS File -->
    <link href="assets/css/style.css" rel="stylesheet">

    <!-- =======================================================
  * Template Name: Laura - v2.0.0
  * Template URL: https://bootstrapmade.com/laura-free-creative-bootstrap-theme/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>

    <!-- ======= Header ======= -->
    <header id="header" class="fixed-top  d-flex justify-content-center align-items-center">

        <nav id="nav" class="nav-colour nav-menu-scrolled nav-menu d-none d-lg-block d-md-block">
            <ul>
                <li class="active"><a href="./">Home</a></li>
                <li><a href="./#about">About</a></li>
                <li><a href="./#resume">Resume</a></li>
                <li><a href="./#portfolio">Portfolio</a></li>
                <li><a href="./#contact">Contact</a></li>

            </ul>
        </nav>
        <!-- .nav-menu -->

    </header>
    <!-- End Header -->

    <main id="main">
        <div class="container align-content-center smallMargin">
            <div class="paper-header">
                <h2>AnoDDPM: Anomaly Detection with Denoising Diffusion Probabilistic Models using Simplex Noise</h2>
                <div class="row" style="margin-top: 40px;">
                    <div class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-3">
                        <h3>Julian Wyatt</h3>
                    </div>
                    <div class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-3">
                        <h3>Adam Leach</h3>
                    </div>
                    <div class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-3">
                        <h3>Sebastian M. Schmon</h3>
                    </div>
                    <div class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-3">
                        <h3>Chris G. Willcocks</h3>
                    </div>
                    <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
                        <h4><img style="vertical-align:top; width:auto; height: 24px;" src="./assets/img/portfolio/DurhamLogo.jpg">&nbsp;Durham University<br><br>This work was accepted at the CVPR workshop: NTIRE June 2022</h4>

                    </div>
                </div>
            </div>
            <br>
            <div class="abstract">
                <p>
                    <b>Abstract</b> Generative models have been shown to provide a powerful mechanism for anomaly detection by learning to model healthy or normal reference data which can subsequently be used as a baseline for scoring anomalies. In this
                    work we consider denoising diffusion probabilistic models (DDPMs) for unsupervised anomaly detection. DDPMs have superior mode coverage over generative adver- sarial networks (GANs) and higher sample quality than variational autoencoders
                    (VAEs). However, this comes at the expense of poor scalability and increased sampling times due to the long Markov chain sequences required. We observe that within reconstruction-based anomaly detection a full-length Markov chain diffu-
                    sion is not required. This leads us to develop a novel partial diffusion anomaly detection strategy that scales to high-resolution imagery, named AnoDDPM. A secondary problem is that Gaussian diffusion fails to capture larger anomalies;
                    therefore we develop a multi-scale simplex noise diffusion process that gives control over the target anomaly size. AnoDDPM with simplex noise is shown to significantly outperform both f-AnoGAN and Gaussian diffusion for the tumorous
                    dataset of 22 T1-weighted MRI scans (CCBS Edinburgh) qualitatively and quantitatively (improvement of +25.5% Sørensen–Dice coefficient, +17.6% IoU and +7.4% AUC).
                </p>
            </div>

            <div class="row paper-links">
                <div class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-3 ">
                    <a href="https://openaccess.thecvf.com/content/CVPR2022W/NTIRE/html/Wyatt_AnoDDPM_Anomaly_Detection_With_Denoising_Diffusion_Probabilistic_Models_Using_Simplex_CVPRW_2022_paper.html">
                        <h4 style="text-align: center"><i class="bx bx-book"></i>&nbsp;CVF</h4>
                    </a>
                </div>
                <div class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-3 ">
                    <a href="https://openaccess.thecvf.com/content/CVPR2022W/NTIRE/papers/Wyatt_AnoDDPM_Anomaly_Detection_With_Denoising_Diffusion_Probabilistic_Models_Using_Simplex_CVPRW_2022_paper.pdf">
                        <h4 style="text-align: center"><i class="bx bxs-file-pdf"></i>&nbsp;Paper</h4>
                    </a>
                </div>
                <div class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-3 ">
                    <a href="#" id="pdfOnClick">
                        <h4 style="text-align: center"><i class="bx bx-slideshow"></i>&nbsp;Poster</h4>
                    </a>
                </div>
                <div class="col-6 col-sm-6 col-md-6 col-lg-6 col-xl-3 ">
                    <a href="https://github.com/Julian-Wyatt/AnoDDPM">
                        <h4 style="text-align: center"><i class="bx bxl-github"></i>&nbsp;Code</h4>
                    </a>
                </div>
            </div>

            <h2 style="margin-top: 30px;">Approach</h2>
            <p>
                AnoDDPM utilises the <b>D</b>enoising <b>D</b>iffusion <b>P</b>robabilistic <b>M</b>odel framework to detect whether a region of an image lies outside of a learned healthy distribution. DDPMs consist of a forward process which slowly adds
                noise to an image and then estimates that noise via a neural network. Through this estimation, new images can be generated by first starting with an approximated image such as white noise, then iteratively predicting the noise and gradually
                reducing the severity of the noise over many steps, until no noise remains. DDPMs are the state of the art for sample quality on small datasets from the powerful procedure, and is therefore ideal for the medical imaging domain. <br> We
                found typical Gaussian noise to be insuffient for anomaly detection as new samples would be generated rather than solely removing the anomaly. Additionally, natural images have been shown to have a power law distribution of frequencies,
                where lower frequency components contribute more to the image. Therefore, we explore the use of simplex noise, a structured noise function, for the corruption and sample generation of medical images.

            </p>
            <div class="row">
                <div class="col-12 col-sm-12 col-md-6 col-lg-6 col-xl-3 d-flex justify-content-center" style="text-align: center;">
                    <figure>
                        <img src="./assets/img/portfolio/anoddpm1-compressed.gif" alt="AnoDDPM GIF 1" style="width:80%; margin:20px">
                        <figcaption>Simplex noise</figcaption>
                    </figure>
                </div>
                <div class="col-12 col-sm-12 col-md-6 col-lg-6 col-xl-3 d-flex justify-content-center" style="text-align: center;">
                    <figure>
                        <img src="./assets/img/portfolio/anoddpm2-compressed.gif" alt="AnoDDPM GIF 2" style="width:80%; margin:20px">
                        <figcaption>Simplex noise</figcaption>
                    </figure>
                </div>
                <div class="col-12 col-sm-12 col-md-6 col-lg-6 col-xl-3 d-flex justify-content-center" style="text-align: center;">
                    <figure>
                        <img src="./assets/img/portfolio/anoddpm3-compressed.gif" alt="AnoDDPM GIF 3" style="width:80%; margin:20px">
                        <figcaption>Simplex noise</figcaption>
                    </figure>
                </div>
                <div class="col-12 col-sm-12 col-md-6 col-lg-6 col-xl-3 d-flex justify-content-center" style="text-align: center;">
                    <figure>
                        <img src="./assets/img/portfolio/anoddpmGauss.gif" alt="AnoDDPM GIF Gauss" style="width:80%; margin:20px">
                        <figcaption>Gaussian noise</figcaption>
                    </figure>
                </div>
            </div>
            <h3 style="margin-top: 30px;">Algorithm</h3>
            <p>
                For our training procedure, we follow the DDPM outline above and predict the noise at a given timestep solely for healthy data. This subsequently learns a model which can generate healthy images. For the anomaly detection of a sample after training we
                apply noise to a parameterised timestep &lambda;, and gradually remove this noise via the typical DDPM algorithm. Once the noise has been removed, we perform a square error pixel-wise comparison of the original and generated image and
                take a threshold of this to evaluate the model. We utilise simplex noise and Gaussian noise for this procedure, with demonstrations above.
            </p>

            <div class="row">
                <div class="col-12 col-sm-12 col-md-6 col-lg-6 col-xl-4 d-flex justify-content-center align-middle" style="text-align: center;">
                    <figure style="margin-top: auto; margin-bottom: auto;">
                        <img src="./assets/img/portfolio/curated-simplex.png" alt="AnoDDPM curated simplex" style="width:90%; margin:20px;margin-left:15px">
                        <figcaption>Curated simplex noise samples</figcaption>
                    </figure>
                </div>
                <div class="col-12 col-sm-12 col-md-6 col-lg-6 col-xl-4 d-flex justify-content-center align-middle" style="text-align: center;">
                    <figure style="margin-top: auto; margin-bottom: auto;">
                        <img src="./assets/img/portfolio/gaussian-header.png" alt="AnoDDPM header" style="width:85%; margin:20px; margin-bottom: 0px; margin-left:30px;margin-top:15px">
                        <img src="./assets/img/portfolio/gaussian-samples.png" alt="gaussian" style="width:90%; margin:20px; margin-top:0px; margin-left:15px">
                        <figcaption>Gaussian noise sample - &lambda; as 250, 500 & 750</figcaption>
                    </figure>
                </div>
                <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-4 d-flex justify-content-center align-middle" style="text-align: center;">
                    <figure>
                        <img src="./assets/img/portfolio/simplex-freq.png" alt="AnoDDPM increasing frequency" style="width:90%; margin:20px; margin-top:5px">
                        <figcaption>Simplex noise with increasing frequency </figcaption>
                    </figure>
                </div>
            </div>

            <h3 style="margin-top: 10px;">Conclusion</h3>
            <ul>
                <li>AnoDDPM outperforms popular anomaly detection technique: f-AnoGAN for MRI brain tumour detection.</li>
                <li>AnoDDPM with Gaussian noise produces high quality samples but struggles to segment anomalies.</li>
                <li>Use of simplex noise produces a slightly lower image quality but produces a more performant residual map.</li>
            </ul>

            <div class="abstract">
                <h3>Citation</h3>
                <pre style="white-space: pre;">
<code style="margin-left:20px">@InProceedings{Wyatt_2022_CVPR,
	author    = {Wyatt, Julian and Leach, Adam and Schmon, Sebastian M. and Willcocks, Chris G.},
	title     = {AnoDDPM: Anomaly Detection With Denoising Diffusion Probabilistic Models Using Simplex Noise},
	booktitle = {Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR) Workshops},
	month     = {June},
	year      = {2022},
	pages     = {650-656}
}</code>
				</pre>
            </div>
        </div>
        <div id="adobe-pdf"></div>
        <!-- <div class="container col-xl-6" id="pdf1" style="margin-bottom: 20px;margin-top:20px"> -->

        </div>
    </main>
    <!-- End #main -->

    <!-- ======= Footer ======= -->
    <footer id="footer">
        <div class="container" id="contact">
            <h3>Julian Wyatt</h3>
            <p>If you wish to contact me to ask any questions about any of my work or to view my work, please use the social links below.<br> I would love to hear from you!</p>
            <p><strong>Email:</strong> julian_wyatt@hotmail.com</p>
            <div class="social-links">
                <a href="https://github.com/Julian-Wyatt" class="github"><i class="bx bxl-github"></i></a>
                <a href="https://www.linkedin.com/in/julian-wyatt-284468174/" class="linkedin"><i class="bx bxl-linkedin"></i></a>
            </div>
            <br> Favicon Rights are owned by: <a href="https://www.icons8.com">icons8.com</a>


        </div>
    </footer>
    <!-- End Footer -->

    <a href="#" class="back-to-top"><i class="icofont-simple-up"></i></a>
    <!-- insert just before the closing body tag </body> -->
    <script type="text/javascript">
        document.addEventListener("adobe_dc_view_sdk.ready", function() {
            document.getElementById("pdfOnClick").addEventListener("click", function() {
                var adobeDCView = new AdobeDC.View({
                    clientId: "5f8b561edef94b828f638632cbc4013b",
                    divId: "adobe-pdf"
                });
                adobeDCView.previewFile({
                    content: {
                        location: {
                            url: "./assets/pdfs/anoddpm-poster.pdf"
                        }
                    },
                    metaData: {
                        fileName: "anoddpm-poster.pdf"
                    }
                }, {
                    embedMode: "LIGHT_BOX",
                    showPrintPDF: false
                });
            })
        });
    </script>

    <!-- Vendor JS Files -->
    <script src="assets/vendor/jquery/jquery.min.js"></script>
    <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/vendor/owl.carousel/owl.carousel.min.js"></script>
    <script src="assets/js/carousel.js"></script>
    <script src="assets/js/mobileNav.js"></script>
</body>

</html>